*       ЪДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДї
*       є                                                         є
*       є 24.10.97              EVTZ.SPR                 13:42:45 є
*       є                                                         є
*       єДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДє
*       є                                                         є
*       є Author's Name                                           є
*       є                                                         є
*       є Copyright (c) 1997 Company Name                         є
*       є Address                                                 є
*       є City,     Zip                                           є
*       є                                                         є
*       є Description:                                            є
*       є This program was automatically generated by GENSCRN.    є
*       є                                                         є
*       АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЩ


#REGION 0
REGIONAL m.currarea, m.talkstat, m.compstat

IF SET("TALK") = "ON"
	SET TALK OFF
	m.talkstat = "ON"
ELSE
	m.talkstat = "OFF"
ENDIF
m.compstat = SET("COMPATIBLE")
SET COMPATIBLE FOXPLUS

m.currarea = SELECT()


*       ЪДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДї
*       є                                                         є
*       є                    Window definitions                   є
*       є                                                         є
*       АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЩ
*

IF NOT WEXIST("_rp40te2n2")
	DEFINE WINDOW _rp40te2n2 ;
		FROM INT((SROW()-9)/2),INT((SCOL()-65)/2) ;
		TO INT((SROW()-9)/2)+8,INT((SCOL()-65)/2)+64 ;
		TITLE " Evidence technickмch zhodnocenЎ " ;
		NOFLOAT ;
		NOCLOSE ;
		SHADOW ;
		DOUBLE ;
		COLOR SCHEME 13
ENDIF


*       ЪДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДї
*       є                                                         є
*       є               EVTZ Setup Code - SECTION 2               є
*       є                                                         є
*       АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЩ
*

#REGION 1
**	SETUP  **
PRIV m.orivar, fl_modi
orivar=""
fl_modi=.F.
IF m.app
	SCAT MEMVAR BLANK
	invc=evim.invc
	dttz=date()
	m_add=dtos(date())+sys(3)
  ELSE
	SCAT MEMVAR
	ENDIF



*       ЪДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДї
*       є                                                         є
*       є                   EVTZ Screen Layout                    є
*       є                                                         є
*       АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЩ
*

#REGION 1
IF WVISIBLE("_rp40te2n2")
	ACTIVATE WINDOW _rp40te2n2 SAME
ELSE
	ACTIVATE WINDOW _rp40te2n2 NOSHOW
ENDIF
@ 0,2 SAY "Invent rnЎ џЎslo:"
@ 0,35 SAY "N zev:"
@ 3,2 SAY "Datum TZ:"
@ 1,2 SAY "PoэizovacЎ cena:"
@ 1,35 SAY "Datum poэЎzenЎ:"
@ 5,2 SAY "Text:"
@ 0,20 GET evim.invc ;
	SIZE 1,10 ;
	DEFAULT " " ;
	DISABLE
@ 0,42 GET evim.naz ;
	SIZE 1,20 ;
	DEFAULT " " ;
	DISABLE
@ 1,20 GET evim.porcena ;
	SIZE 1,12 ;
	DEFAULT 0 ;
	DISABLE
@ 1,52 GET evim.dat ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	DISABLE
@ 3,12 GET m.dttz ;
	SIZE 1,10 ;
	DEFAULT {  /  /  } ;
	WHEN _rp40te2pm() ;
	VALID _rp40te2q1() ;
	MESSAGE "Datum provedenЎ technick‚ho zhodnocenЎ."
@ 3,47 GET m.cas ;
	SIZE 1,12 ;
	DEFAULT " " ;
	PICTURE "999999999.99" ;
	WHEN _rp40te2qm() ;
	VALID _rp40te2qy() ;
	MESSAGE "¬ stka o kterou se mШnЎ hodnota IM. + = ZvмзenЎ; - = SnЎ§enЎ hodnoty."
@ 5,12 GET m.txt ;
	SIZE 1,25 ;
	DEFAULT " " ;
	WHEN _rp40te2rg() ;
	VALID _rp40te2rs() ;
	MESSAGE "Text doplеujЎcЎ pэЎџinu technick‚ho zhodnocenЎ."
@ 6,54 GET m.ok ;
	PICTURE "@*HT \! OK " ;
	SIZE 1,8,1 ;
	DEFAULT 1 ;
	COLOR SCHEME 1
@ 3,35 SAY "Hodnota TZ:"

IF NOT WVISIBLE("_rp40te2n2")
	ACTIVATE WINDOW _rp40te2n2
ENDIF

READ CYCLE MODAL

RELEASE WINDOW _rp40te2n2
SELECT (m.currarea)


#REGION 0
IF m.talkstat = "ON"
	SET TALK ON
ENDIF
IF m.compstat = "ON"
	SET COMPATIBLE ON
ENDIF


*       ЪДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДї
*       є                                                         є
*       є                    EVTZ Cleanup Code                    є
*       є                                                         є
*       АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЩ
*

#REGION 1
**	CLEAN UP  **
esc= lastkey()=27
IF m.fl_modi AND !(m.esc AND !ask(-1,-1,'N',"Zapsat zmШny"))
	m_user=m.gl_usernam
	m_date=date()
	m_time=time()
	IF m.app
		INSERT INTO (alias()) FROM MEMVAR
	  ELSE
		GATHER MEMVAR
		ENDIF
	ENDIF



*       ЪДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДї
*       є                                                         є
*       є _RP40TE2PM           m.dttz WHEN                        є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Screen:         EVTZ,     Record Number:   12      є
*       є Variable:            m.dttz                             є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      1                                  є
*       є                                                         є
*       АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЩ
*
FUNCTION _rp40te2pm     &&  m.dttz WHEN
#REGION 1
orivar=eval("m."+sys(18))


*       ЪДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДї
*       є                                                         є
*       є _RP40TE2Q1           m.dttz VALID                       є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Screen:         EVTZ,     Record Number:   12      є
*       є Variable:            m.dttz                             є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      2                                  є
*       є                                                         є
*       АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЩ
*
FUNCTION _rp40te2q1     &&  m.dttz VALID
#REGION 1
IF evim.dat>m.dttz
	WAIT WIND NOWA "Datum TZ nem…§e bмt ni§зЎ ne§ datum poэЎzenЎ."
	RETURN 0
	ENDIF

IF eval("m."+sys(18))!=m.orivar AND !m.fl_modi
	fl_modi=.T.
	ENDIF


*       ЪДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДї
*       є                                                         є
*       є _RP40TE2QM           m.cas WHEN                         є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Screen:         EVTZ,     Record Number:   13      є
*       є Variable:            m.cas                              є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      3                                  є
*       є                                                         є
*       АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЩ
*
FUNCTION _rp40te2qm     &&  m.cas WHEN
#REGION 1
orivar=eval("m."+sys(18))


*       ЪДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДї
*       є                                                         є
*       є _RP40TE2QY           m.cas VALID                        є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Screen:         EVTZ,     Record Number:   13      є
*       є Variable:            m.cas                              є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      4                                  є
*       є                                                         є
*       АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЩ
*
FUNCTION _rp40te2qy     &&  m.cas VALID
#REGION 1
IF eval("m."+sys(18))!=m.orivar AND !m.fl_modi
	fl_modi=.T.
	ENDIF


*       ЪДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДї
*       є                                                         є
*       є _RP40TE2RG           m.txt WHEN                         є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Screen:         EVTZ,     Record Number:   14      є
*       є Variable:            m.txt                              є
*       є Called By:           WHEN Clause                        є
*       є Object Type:         Field                              є
*       є Snippet Number:      5                                  є
*       є                                                         є
*       АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЩ
*
FUNCTION _rp40te2rg     &&  m.txt WHEN
#REGION 1
orivar=eval("m."+sys(18))


*       ЪДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДї
*       є                                                         є
*       є _RP40TE2RS           m.txt VALID                        є
*       є                                                         є
*       є Function Origin:                                        є
*       є                                                         є
*       є From Screen:         EVTZ,     Record Number:   14      є
*       є Variable:            m.txt                              є
*       є Called By:           VALID Clause                       є
*       є Object Type:         Field                              є
*       є Snippet Number:      6                                  є
*       є                                                         є
*       АДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДДЩ
*
FUNCTION _rp40te2rs     &&  m.txt VALID
#REGION 1
IF eval("m."+sys(18))!=m.orivar AND !m.fl_modi
	fl_modi=.T.
	ENDIF
